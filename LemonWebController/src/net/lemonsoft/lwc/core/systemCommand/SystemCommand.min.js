/*! SystemCommand 23-08-2016 

 Lemonsoft Technology */

function Browser(){var a=window.browser.create();this.getId=function(){return a},this.show=function(){Log.info("run show");try{window.browser.show(a)}catch(a){Log.error("e.message"+a.message)}Log.info("run show over")},this.hide=function(){Log.info("run hide"),window.browser.hide(a),Log.info("run hide over")},this.close=function(){window.browser.close(a)},this.setSize=function(b,c){window.browser.setSize(a,b,c)},this.setPosition=function(b,c){window.browser.setPosition(a,b,c)},this.executeJavaScript=function(b){return window.browser.executeJavaScript(a,b)},this.operate=new BrowserOperate(this),this.dataGet=new BrowserDataGet(this)}function BrowserDataGet(a){var b=a;this.getDomAttribute=function(a,c){return b.executeJavaScript("document.querySelector('"+a+"').getAttribute('"+c+"')")},this.getDomProperty=function(a,c){return b.executeJavaScript("document.querySelector('"+a+"')."+c)},this.getInnerHTML=function(a){try{var b=this.getDomProperty(a,"innerHTML");return Log.success("根据脚本命令获取指定元素的innerHTML成功"),b}catch(a){return Log.warning("获取指定元素的innerHTML失败:"+a),null}},this.getOuterHTML=function(a){try{var b=this.getDomProperty(a,"outerHTML");return Log.success("根据脚本命令获取指定元素的outerHTML成功"),b}catch(a){return Log.warning("获取指定元素的outerHTML失败:"+a),null}},this.getInnerText=function(a){try{var b=this.getDomProperty(a,"innerText");return Log.success("根据脚本命令获取指定元素的innerText成功"),b}catch(a){return Log.warning("获取指定元素的innerText失败:"+a),null}},this.getURL=function(){try{var a=this.executeJS("location.href");return Log.success("根据脚本命令获取当前采集数据的界面的URL成功"),a}catch(a){return Log.warning("获取当前采集数据的界面的URL失败:"+a),null}},this.getImgDomURL=function(a){try{var b=this.getDomProperty(a,"src");return Log.success("根据脚本命令获取指定图片Dom元素的图片URL成功"),b}catch(a){return Log.warning("获取指定图片Dom元素的图片URL失败:"+a),null}},this.getADomURL=function(a){try{var b=this.getDomProperty(a,"href");return Log.success("根据脚本命令获取指定A标记的的链接URL成功"),"aa"+b}catch(a){return Log.warning("获取指定A标记的的链接URL失败:"+a),null}}}function BrowserOperate(a){var b=a;this.loadURL=function(a,c,d){window.browser.loadURL(b.getId(),a,c,d)},this.setDomAttribute=function(a,c,d){b.executeJavaScript("document.querySelector('"+a+"').setAttribute('"+c+"' , '"+d+"')")},this.setDomProperty=function(a,c,d){b.executeJavaScript("document.querySelector('"+a+"')."+c+" = '"+d+"'")},this.invokeDomFunction=function(a,c,d){b.executeJavaScript("document.querySelector('"+a+"')."+c+"("+d.join(",")+")")},this.invokeDomMouseAction=function(a,c){b.executeJavaScript(String.format("window.eval(\"var event = document.createEvent('MouseEvents');event.initMouseEvent('%s',true,true,window,0,0,0,0,0,false,false,false,false,0,null);document.querySelector('%s').dispatchEvent(event);\")",c,a))},this.fillInputText=function(a,b){this.setDomAttribute(a,"value",b),Log.success("在指定的Input文本控件中填写值成功")},this.selectItem=function(a,b){this.setDomProperty("selectedIndex",b),Log.success("选择指定的下拉菜单的下拉项目成功")},this.checkedItem=function(a,b){this.setDomProperty("checked",b?"checked":""),Log.success("选中指定radio或checkbox成功")},this.submitForm=function(a){this.invokeDomFunction(a,"submit",[]),Log.success("触发提交指定的表单成功")},this.sleep=function(a){Log.info("休眠"+a+" 开始"),Util.sleep(a),Log.info("休眠"+a+" 结束")},this.scrollToPosition=function(a,b){this.executeJS("window.scrollTo("+a+" , "+b+")"),Log.success("让当前页面滚动到指定的位置成功")},this.clickDom=function(a){this.invokeDomMouseAction(a,"click"),Log.success("点击指定的Dom元素成功")},this.mouseoverDom=function(a){this.invokeDomMouseAction(a,"mouseover"),Log.success("触发指定Dom元素的鼠标悬浮事件成功")}}function Communication(){}function DataCollection(){}function Log(){}function LogModel(a,b){this.content,this.type,this.time=Math.round((new Date).getTime())}function Util(){}Communication.call=function(a,b){return window.communication.call(a,b)},DataCollection.put=function(a,b){window.dataCollection.put(a,b)},DataCollection.get=function(a){return window.dataCollection.get(a)},DataCollection.remove=function(a){return window.dataCollection.remove(a)},DataCollection.removeAll=function(){window.dataCollection.removeAll()},Log.msg=function(a,b){var c=["logItemSuccess","logItemError","logItemInfo","logItemWarning"],d=["success","error","info","warning"];try{window.log.addLog(JSON.stringify(new LogModel(b,d[a])));var e=document.createElement("div");e.setAttribute("class",c[a]),e.innerText="[LOG]"+b,document.getElementById("logList").appendChild(e)}catch(a){console.log("No GUI to log:"+b)}},Log.success=function(a){this.msg(0,a)},Log.error=function(a){this.msg(1,a)},Log.info=function(a){this.msg(2,a)},Log.warning=function(a){this.msg(3,a)},Util.createUUID=function(){for(var a=[],b="0123456789abcdef",c=0;c<36;c++)a[c]=b.substr(Math.floor(16*Math.random()),1);a[14]="4",a[19]=b.substr(3&a[19]|8,1),a[8]=a[13]=a[18]=a[23]="-";var d=a.join("");return d},Util.getUnixTimeStamp=function(){return Math.round((new Date).getTime())},Util.sleep=function(a){for(var b=new Date,c=b.getTime()+a;;)if(b=new Date,b.getTime()>c)return};